webpackJsonp([32],{C10D:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("BO1k"),s=a.n(o),n={name:"home",data:function(){return{form:{compty:"",word:""},formList:{keyword:"",pro_company:"",page:1,pagesize:10,status:""},total:0,options:[],tableData:[],userList:[]}},created:function(){""!=this.$route.query.status&&(this.formList.status=0==this.$route.query.status?"":this.$route.query.status),this.getCompany(),this.getCompanytype()},watch:{$route:function(t,e){""!=this.$route.query.status&&(this.formList.status=0==this.$route.query.status?"":this.$route.query.status),this.getCompany(),this.getCompanytype()}},methods:{getCompany:function(){var t=this;this.$api.post("/companytype",{type:""},function(e){0==e.errcode&&(t.options=e.data)},function(t){})},getCompanytype:function(){var t=this;t.$api.get("project",t.formList,function(e){if(t.tableData=e.data.data?e.data.data:e.data,t.tableData.length>0){var a=!0,o=!1,n=void 0;try{for(var i,r=s()(t.tableData);!(a=(i=r.next()).done);a=!0){var l=i.value;for(var c in t.options)l.test_company_id==t.options[c].c_id&&(l.test_company_id=t.options[c].company_name),l.company_id==t.options[c].c_id&&(l.company_id=t.options[c].company_name),2==l.status?l.status="已完成":1==l.status&&(l.status=l.project_plan_name)}}catch(t){o=!0,n=t}finally{try{!a&&r.return&&r.return()}finally{if(o)throw n}}t.total=Number(e.data.total_count)}else t.total=0},function(e){t.$message.error(e.msg),t.total=Number(0)})},getClass:function(){return"background: #66CE90FF"},talkBoss:function(t){var e=this,a=this;if(5==a.$utils.getloc("group_id"))return!1;this.$store.commit("xianshi");var o=localStorage.getItem("token");this.$api.getTall("/getFrindChat/?token="+o+"&to_member_id="+t.pro_member,{},function(o){o.data;for(var s="",n=0;n<o.data.length;n++)if(o.data[n].another_id==t.pro_member){var i=n.toString();a.$store.commit("setActiveIndex",i),s=o.data[n].chat_id}var r=o.data;e.$store.commit("setList",r),a.$api.getTall("/getChatMessage",{chat_id:s,page:1},function(t){a.$store.commit("setChatLeftData",t.data.list)})})},onSubmit:function(){this.getCompanytype()},handleSizeChange:function(t){this.formList.pagesize=t,this.getCompanytype()},handleCurrentChange:function(t){this.formList.page=t,this.getCompanytype()},addCompanyList:function(){this.$router.push({name:"test-items-add"})},editRow:function(t){console.log(t);var e=t.id;this.$router.push({path:"/project-show",query:{id:e,ispro:t.status}})},deleteRow:function(t){var e=this,a=t.id,o=this;o.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$api.delete("/project/"+a,{},function(t){e.$message({message:t.message,type:"success"}),e.getCompanytype()},function(t){o.$message.error(t.msg)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},problemList:function(t){this.$router.push({path:"/question-list",query:{id:t.id}})},flawList:function(t){var e=t.id,a=t.pro_name;console.log(t),this.$router.push({path:"/defect-list",query:{projectId:e,conpanyName:a}})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main company-main"},[a("div",{staticClass:"mainHead"},[a("div",{staticClass:"searchBox"},[a("el-form",{ref:"formList",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formList}},[a("div",{staticClass:"search-input"},[a("el-form-item",{attrs:{label:"公司:"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formList.pro_company,callback:function(e){t.$set(t.formList,"pro_company",e)},expression:"formList.pro_company"}},[a("el-option",[t._v("请选择")]),t._v(" "),t._l(t.options,function(t){return a("el-option",{key:t.c_id,attrs:{label:t.company_name,value:t.c_id}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"关键词:"}},[a("el-input",{attrs:{placeholder:"项目名称/产品名称/项目经理"},model:{value:t.formList.keyword,callback:function(e){t.$set(t.formList,"keyword",e)},expression:"formList.keyword"}})],1),t._v(" "),a("el-button",{staticClass:"btn-query",on:{click:t.onSubmit}},[t._v("搜索")])],1)])],1)]),t._v(" "),a("div",{staticClass:"dataList"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.getClass}},[a("el-table-column",{attrs:{prop:"product_name,version",label:"产品名称(版本)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.product_name)+" ("+t._s(e.row.version)+")")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"company_id",label:"所属公司"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pro_realname",label:"项目经理"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.talkBoss(e.row)}}},[t._v(t._s(e.row.pro_realname))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"addtime",label:"申请时间"}}),t._v(" "),5==t.$utils.getloc("group_id")?a("el-table-column",{attrs:{prop:"test_realname",label:"检测负责人"}}):t._e(),t._v(" "),5==t.$utils.getloc("group_id")?a("el-table-column",{attrs:{prop:"test_company_id",label:"检测单位"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"当前阶段"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operation"},[5==t.$utils.getloc("group_id")?a("span",{staticClass:"oper_edit",on:{click:function(a){return t.editRow(e.row)}}},[t._v("查看")]):t._e(),t._v(" "),2==t.$utils.getloc("group_id")?a("span",{staticClass:"oper_edit",on:{click:function(a){return t.editRow(e.row)}}},[t._v("修改")]):t._e(),t._v(" "),2==t.$utils.getloc("group_id")?a("span",{staticClass:"oper_delet",on:{click:function(a){return t.deleteRow(e.row)}}},[t._v("删除")]):t._e()])]}}])})],1)],1),t._v(" "),a("el-pagination",{attrs:{"prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]};var r=a("VU/8")(n,i,!1,function(t){a("mP+5")},"data-v-60f67502",null);e.default=r.exports},"mP+5":function(t,e){}});
//# sourceMappingURL=32.50aae7b33301500255fd.js.map