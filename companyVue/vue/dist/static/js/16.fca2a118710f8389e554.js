webpackJsonp([16],{"9Mtq":function(e,t){},IG9G:function(e,t){},zjpH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("BO1k"),a=r.n(o),n={data:function(){return{checkedList:[],form:{testid:[],pro_name:"",product_name:"",version:"",project_realname:"",project_mobile:"",company_id:""},options:[],formData:{},tableData:[{date:[],name:"提交测试",executor:"1",sort_order:"1"},{date:[],name:"资料审核",executor:"1",sort_order:"2"},{date:[],name:"资料整改",executor:"2",sort_order:"3"},{date:[],name:"任务下达",executor:"1",sort_order:"4"},{date:[],name:"一轮环境搭建",executor:"1",sort_order:"5"},{date:[],name:"一轮测试",executor:"1",sort_order:"6"},{date:[],name:"一轮整改",executor:"2",sort_order:"7"},{date:[],name:"二轮环境搭建",executor:"1",sort_order:"8"},{date:[],name:"二轮测试",executor:"1",sort_order:"9"},{date:[],name:"测试完成",executor:"1",sort_order:"10"},{date:[],name:"测试报告",executor:"1",sort_order:"11"}]}},created:function(){this.getTestrand(),this.getcompanytype()},methods:{goback:function(){this.$router.go(-1)},getTestrand:function(){var e=this;e.$api.get("/testrand",{type:""},function(t){var r={};for(var o in t.data)(r={}).id=o,r.name=t.data[o],e.checkedList.push(r)},function(t){e.$message.error(t.msg)})},getcompanytype:function(){var e=this;e.$api.post("companytype",{type:1},function(t){for(var r in t.data)e.options.push(t.data[r])})},onSubmit:function(){var e=this;if(""==e.form.pro_name)return e.$message.error("请输入项目名称"),!1;if(""==e.form.product_name)return e.$message.error("请输入产品名称"),!1;if(""==e.form.version)return e.$message.error("请输入版本号"),!1;if(""==e.form.company_id)return e.$message.error("请选择公司"),!1;if(""==e.form.testid)return e.$message.error("请选择检测范围"),!1;if(""==e.form.project_realname)return e.$message.error("请输入项目经理"),!1;if(""==e.form.project_mobile)return e.$message.error("请输入联系方式"),!1;if(!/^[1][3,4,5,7,8][0-9]{9}$/.test(e.form.project_mobile))return e.$message.error("请输入正确的联系方式"),!1;e.form.name=[],e.form.start_time=[],e.form.end_time=[],e.form.executor=[],e.form.sort_order=[];var t=!0,r=!1,o=void 0;try{for(var n,s=a()(e.tableData);!(t=(n=s.next()).done);t=!0){var l=n.value;if(""==l.name)return e.$message.error("流程名称不能为空"),!1;if(""==l.date)return e.$message.error("请选择时间"),!1;if(""==l.executor)return e.$message.error("请选择执行人"),!1;if(""==l.sort_order)return e.$message.error("排序不能为空"),!1;e.form.name.push(l.name),e.form.start_time.push(l.date[0]),e.form.end_time.push(l.date[0]),e.form.executor.push(l.executor),e.form.sort_order.push(l.sort_order)}}catch(e){r=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw o}}e.$api.post("/project",e.form,function(t){e.$message({message:"新增成功",type:"success"}),setTimeout(function(){e.goback()},1e3)})},addPath:function(){self=this;for(var e=[],t=0;t<this.tableData.length-2;t++)e[t]=this.tableData[t];if((this.tableData.length-11)/3+2){var r=(this.tableData.length-11)/3+2,o=["零","一","二","三","四","五"];if(r>4)return self.$message.error("超乎我的预期了"),!1;e.push({date:[],name:o[r]+"轮整改",executor:"2",sort_order:e.length+1}),e.push({date:[],name:o[r+1]+"轮环境搭建",executor:"2",sort_order:e.length+1}),e.push({date:[],name:o[r+1]+"轮测试",executor:"1",sort_order:e.length+1}),e.push({date:[],name:"测试完成",executor:"1",sort_order:e.length+1}),e.push({date:[],name:"测试报告",executor:"1",sort_order:e.length+1}),this.tableData=e}},changeSort:function(e,t){this.tableData.sort(this.compare("sort_order"))},compare:function(e){return console.log(e,"...property"),function(t,r){return t[e]-r[e]}}},mounted:function(){}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"test-items-add-out-box"},[r("div",{staticClass:"information"},[r("div",{staticClass:"button"},[e._v("项目信息")]),e._v(" "),r("div",{staticClass:"information-center"},[r("center",[r("el-form",{ref:"form",attrs:{model:e.form,"label-position":"right","label-width":"120px"}},[r("el-form-item",{attrs:{label:"项目名称:",prop:""}},[r("el-input",{model:{value:e.form.pro_name,callback:function(t){e.$set(e.form,"pro_name",t)},expression:"form.pro_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"产品名称:"}},[r("el-input",{model:{value:e.form.product_name,callback:function(t){e.$set(e.form,"product_name",t)},expression:"form.product_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"产品版本号:"}},[r("el-input",{model:{value:e.form.version,callback:function(t){e.$set(e.form,"version",t)},expression:"form.version"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属公司:"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.company_id,callback:function(t){e.$set(e.form,"company_id",t)},expression:"form.company_id"}},e._l(e.options,function(e){return r("el-option",{key:e.c_id,attrs:{label:e.company_name,value:e.c_id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"测试范围:"}},[r("el-checkbox-group",{model:{value:e.form.testid,callback:function(t){e.$set(e.form,"testid",t)},expression:"form.testid"}},e._l(e.checkedList,function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"项目经理:"}},[r("el-input",{model:{value:e.form.project_realname,callback:function(t){e.$set(e.form,"project_realname",t)},expression:"form.project_realname"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系方式:"}},[r("el-input",{attrs:{maxlength:"11"},model:{value:e.form.project_mobile,callback:function(t){e.$set(e.form,"project_mobile",t)},expression:"form.project_mobile"}})],1)],1)],1)],1)]),e._v(" "),r("div",{staticClass:"technological"},[r("div",{staticClass:"button"},[e._v("检测流程排程")]),e._v(" "),r("div",{staticClass:"technological-table"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{prop:"",label:"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{disabled:"",placeholder:"请输入流程名称"},model:{value:t.row.name,callback:function(r){e.$set(t.row,"name",r)},expression:"scope.row.name"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"date",label:"",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.row.date,callback:function(r){e.$set(t.row,"date",r)},expression:"scope.row.date"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"",label:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{placeholder:"执行人",disabled:""},model:{value:t.row.executor,callback:function(r){e.$set(t.row,"executor",r)},expression:"scope.row.executor"}},[r("el-option",{attrs:{label:"检测方",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"送检方",value:"2"}})],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"",label:"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{placeholder:"排序",disabled:""},on:{blur:function(r){return e.changeSort(t.row.sort_order,t.$index)}},model:{value:t.row.sort_order,callback:function(r){e.$set(t.row,"sort_order",r)},expression:"scope.row.sort_order"}})]}}])})],1),e._v(" "),r("el-button",{staticStyle:{"margin-top":"20px"},on:{click:e.addPath}},[e._v("增加流程")]),e._v(" "),r("div",{staticClass:"btn-box"},[r("el-button",{attrs:{type:"success",size:"medium"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.goback}},[e._v("返回")])],1)],1)])])},staticRenderFns:[]};var l=r("VU/8")(n,s,!1,function(e){r("IG9G"),r("9Mtq")},"data-v-4b9f5770",null);t.default=l.exports}});
//# sourceMappingURL=16.fca2a118710f8389e554.js.map